{% load static %}
<!DOCTYPE html>
<html>
	

	<head>
		<style>
			.row {
	  display: flex;
	}
	
	.column {
	  flex: 33.33%;
	  padding: 5px;
	}
		</style>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
		<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.css" rel="stylesheet">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" integrity="sha512-vKMx8UnXk60zUwyUnUPM3HbQo8QfmNx7+ltw8Pm5zLusl1XIfwcxo8DbWCqMGKaWeNxWA8yrx5v3SaVpMvR3CA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.css" integrity="sha512-3pIirOrwegjM6erE5gPSwkUzO+3cTjpnV9lexlNZqvupR64iZBnOOTiiLPb9M36zpMScbmUNIcHUqKD47M719g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
		<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
		<link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">					
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" integrity="sha512-mSYUmp1HYZDFaVKK//63EcZq4iFWFjxSL+Z3T/aCt4IO9Cejm03q3NKKYN6pFQzY0SBOr8h+eCIAZHPXcpZaNw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		
	</head>

	<body>
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
			  <span class="navbar-toggler-icon"></span>
			</button>
			<a class="navbar-brand" href="#">Sahayatri</a>
		  
			<div class="collapse navbar-collapse" id="navbarTogglerDemo03">
			  <ul class="navbar-nav mr-auto mt-2 mt-lg-0">				
				<li class="nav-item">
				  <a class="nav-link active form-control mr-sm-2" href="#">{{ request.user.username }}</a>
				</li>
				<li class="nav-item">
				  <a class="nav-link " data-toggle="modal" data-target="#logoutModal">Logout</a>
				</li>
			  </ul>
			  <form class="form-inline my-2 my-lg-0">
				<input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
				<button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
			  </form>
			</div>
		  </nav>
		  <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
			  <div class="modal-content">
				<div class="modal-header">
				  <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
				  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				  </button>
				</div>
				<div class="modal-body">
				  Are you sure you want to Logout as {{ request.user.username }}?
				</div>
				<div class="modal-footer">
				  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				  <button type="button" class="btn btn-primary" ><a href="{% url 'logout' %}">Logout</a></button>
				</div>
			  </div>
			</div>
		  </div>		
		<form method="POST" enctype="multipart/form-data">
			{% csrf_token %}
		<div class="container register">
			<div class="row">
				
				<div class="col-md-12 register-right">
					<ul class="nav nav-tabs nav-justified" id="myTab" role="tablist">
						<li class="nav-item">
							<a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Add Package</a>
						</li>					
					</ul>
					<div class="tab-content" id="myTabContent">
						<div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
							<div class="row register-form">
								<div class="col-md-4">
									<div class="form-group">
										<label>
											Package Name
										</label>
										<input type="text" class="form-control" id="pname" placeholder="Package Name" value="" />									
									</div>
									<div class="form-group">
										<label>
											Price
										</label>
										<input type="number" class="form-control" id="price" placeholder="Price" min="0" value="" />
									</div>								
									<div class="form-group">
										<label>
											Description
										</label>
										<input type="text" class="form-control" id="desc" placeholder="Description" value="" />
									</div>
									<div class="form-group">
										<label>
											Duration
										</label>
										<input type="number" class="form-control" id="nights" placeholder="Duration" value="" />
										<span>Nights</span>
										<input type="number" class="form-control" id="days" placeholder="Duration" value="" />
										<span>Days</span>
									</div>	
									<div class="form-group">									
										<label>Choose Photos</label>
										<input accept="image/*" multiple type='file' id="imgInp" />									
										<!-- <input type="file" class="form-control"  onchange="readURL(this);" data-count="1" placeholder="Upload Thumbnail" value="" />									
										<img id="blah1" alt="your image" /> -->
									</div>
									<div class="row">
										<div class="col-lg-4 col-md-4 col-xs-4 thumb container">
											<img id="first" alt="Snow" style="width:100%">											 
										  </div>
										  <div class="col-lg-4 col-md-4 col-xs-4 thumb container">
											<img id="second" alt="Forest" style="width:100%">											 
										  </div>
										  <div class="col-lg-4 col-md-4 col-xs-4 thumb container">
											<img id="third" alt="Mountains" style="width:100%">											 
										  </div>
										  <div class="col-lg-4 col-md-4 col-xs-4 thumb container">
											  <img id="fourth" alt="Mountains" style="width:100%">											   
										  </div>
									</div>		
									<div class="form-group">
										<label>Category</label>
										<select class="form-control" id="packageType">
											<option value="0"  selected>Choose Package Type</option>
											{% for ct in catlist %}								
											<option value="{{ ct.id }}" data-sp="{{ ct.startPrice }}" data-ep="{{ ct.endPrice }}">{{ ct.name }} ({{ ct.startPrice }} - {{ ct.endPrice }} )</option>										
											{% endfor %}
										</select>
									</div>	
									
									<div class="form-group">
										<label>Province</label>
										<select class="form-control" id="province">
											<option value="0" selected>Choose Provice</option>
											{% for p in prov %}
											<option value="{{ p.id }}">{{ p.name }}</option>
											{% endfor %}
										</select>
									</div>	
									<div class="form-group">
										<label>District</label>
										<select class="form-control" id="district">
											<option value="0" selected>Choose District</option>
											{% for d in dist %}
											<option value="{{ d.id }}">{{ d.name }}</option>
											{% endfor %}
										</select>
									</div>	
									<div class="form-group">
										<label>
											Discount
										</label>
										<input type="number" class="form-control" id="Discount" placeholder="Enter Discount" value="" />
									</div>																								
												  
								</div>							
								<div id="url" data-url="{% url 'DistrictList' %}" hidden></div>
								<div id="url1" data-url="{% url 'MuniList' %}" hidden></div>
								<div id="url2" data-url="{% url 'InsertPackage' %}" hidden></div>
								<div class="col-md-8">																	
									<div class="form-group">
										<label>
											Inclusions
										</label><span><input type="checkbox" id="checkin">Load Default Value</span>
										<textarea type="text" class="form-control" id="inclusion" placeholder="Overview" value=""></textarea>
									</div>
									<div class="form-group">
										<label>
											Exclusions
										</label><span><input type="checkbox" id="checkex">Load Default Value</span>
										<textarea type="text" class="form-control" id="exclusion" placeholder="Overview" value=""></textarea>
									</div>					
									<div class="form-group">
										<label>
											Overview
										</label>
										<textarea type="text" class="form-control" id="overview" placeholder="Overview" value=""></textarea>
									</div>								
									
									<div class="form-group">
										<label>
											Itnerary
										</label><span><input type="checkbox" id="checkit">Load Default Itnerary</span>
										<textarea type="text" class="form-control" id="itnerary" placeholder="Overview" value=""></textarea>
									</div>
									<div class="row col-md-12">
										<div class="form-group">
											<label>Municipality</label>
											<select class="form-control" id="muni">
												<option value="0" selected>Choose Municipality</option>
												{% for m in muni %}
												<option value="{{ m.id }}">{{ m.name }}</option>
												{% endfor %}
											</select>
										</div>	
										<div class="form-group">
											<label>Type</label>
											<select class="form-control" id="catType">
												<option value="0"  selected >Choose Tour Category</option>
												{% for d in data %}
												<option value="{{ d.id }}">{{ d.name }}</option>
												{% endfor %}
											</select>
										</div>	
										<div class="form-group">
											<label>
												Valid Date										
											<input type="datetime" class="form-control bootstrap-datepicker" id="datetime" placeholder="" value="" />
										</div>
									</div>									
									<div class="row">
										<div class="form-group">									
											<label>Thumbnail Image</label>
											<input type="file" class="form-control" id="thumbImg" placeholder="Upload Thumbnail" value="" />																		
										</div>	
										<div class="row">
											<div class="col-lg-4 col-md-4 col-xs-4 thumb1">
												<img id="thumbnail" alt="Snow" style="width:100%">
											</div>									  
										</div>																		
										<div class="form-group col-md-4">
											<input type="button" class="btnAddPrimary" id="btnAddPrimary" onclick="InsertPackage(1);" value="Add Product"/>
										</div>							
									</div>
											
								</div>
								</div>
							</div>
						</div>					
					</div>
				</div>
			</div>		
	</div>
	  </form><br><br>
	  <section>
		<table class="table">
			<thead class="thead-dark">
			  <tr>
				<th scope="col">S.N</th>
				<th scope="col">Package Name</th>
				<th scope="col">Price</th>
				<th scope="col">Valid Date</th>
				<th scope="col">Action</th>
			  </tr>
			</thead>
			<tbody>
				{% for p in prod %}
			  <tr>
				
				<th scope="row">{{ forloop.counter }}</th>
				<td>{{ p.name }}</td>
				<td>{{ p.price }}</td>
				<td>{{ p.valid_date }}</td>
				<td><button id="btnUpdatePac" onclick="GetDetails('{{ p.id }}')"><i class="fa fa-edit"></i></button> <button id="btnDeletePac"><i class="fa fa-trash"></i></button></td>
			  </tr>
			  {% endfor %}
			</tbody>
	  </section>
	 <footer>
		
		<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js" integrity="sha512-VEd+nq25CkR676O+pLBnDW09R7VQX9Mdiij052gVCp5yVH3jGtH70Ho/UUv4mJDsEdTvqRCFZg0NKGiojGnUCw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<script src="{% static 'js/addpackage.js' %}"></script>	
	 </footer> 
	</body>
</html>

<script>


	function GetDetails(p_id){
		$.ajax({
            url:"{% url 'getPackageDetails' %}",
            type:'POST',
            dataType:'json',
            data:{id:p_id},
            headers: {
                  "X-CSRFToken": "{{csrf_token}}"
                },
            success:function(data){
                $('#pname').val(data[0].fields.name);
                $('#price').val(data[0].fields.price);
                $('#desc').val(data[0].fields.description);
				$('#nights').val(data[0].fields.nights);
				$('#days').val(data[0].fields.days);
				$('#packageType').val(data[0].fields.category).change();
				$('#datetime').val(data[0].fields.valid_date);
				$('#Discount').val(data[0].fields.discount);
				$('#inclusion').summernote('code',data[0].fields.inclusions);
				$('#exclusion').summernote('code',data[0].fields.exclusions);
				$('#overview').summernote('code',data[0].fields.overview);
				$('#itnerary').summernote('code',data[0].fields.Itnerary);
            },
            error:function(){               
                toastr.error("Unable to get detail!","Error",options);
            }
        });
	}

</script>

